<!DOCTYPE html><html lang="nl">
<head>
  <meta charset="UTF-8" />
  <title>ğŸš² Fiets Game Bergen â€“ Marion met Pensioen</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet-routing-machine@3.2.12/dist/leaflet-routing-machine.css" />  <style>
    html, body { margin:0; padding:0; height:100%; font-family:system-ui,sans-serif; }
    #map { height:100%; width:100%; }

    .ui {
      position:absolute; top:10px; left:10px; z-index:1000;
      background:white; padding:14px; border-radius:12px;
      box-shadow:0 6px 18px rgba(0,0,0,0.25); max-width:320px;
    }

    h2 { margin:0 0 6px 0; font-size:18px; }
    button {
      width:100%; margin-top:6px; padding:10px;
      border:none; border-radius:8px;
      background:#2563eb; color:white; font-size:14px;
    }
    .small { font-size:13px; margin-top:6px; }
    .score { margin-top:6px; font-size:13px; }
  </style></head>
<body><div class="ui">
  <h2>ğŸš² Fiets Game Bergen</h2>
  <p class="small">Samen fietsen langs mooie plekken.<br>Teams wisselen, iedereen blijft samen.</p><button onclick="volgendeLocatie()">ğŸ“ Volgende locatie</button> <button onclick="shuffleTeams()">ğŸ‘¥ Nieuwe teams</button> <button onclick="puntenTeam('A')">â• Punt Team A</button> <button onclick="puntenTeam('B')">â• Punt Team B</button>

  <div id="info" class="small"></div>
  <div id="score" class="score"></div>
</div><div id="map"></div><script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script><script src="https://unpkg.com/leaflet-routing-machine@3.2.12/dist/leaflet-routing-machine.js"></script><script>
// =========================
// DATA
// =========================

const spelers = ['Marion','Anna','Jan','Pieter','Sophie','Tom'];

const locaties = [
  { naam:'Bergen Centrum (Start)', coords:[52.6696,4.7053], opdracht:'Check fietsen & start samen.' },
  { naam:'Bergerbos', coords:[52.6739,4.6825], opdracht:'ğŸ“¸ Maak een groepsfoto met bomen.' },
  { naam:'Schoorlse Duinen', coords:[52.6919,4.6732], opdracht:'ğŸ§  Vertel een leuk feitje over Marion.' },
  { naam:'Duinweg Uitzicht', coords:[52.6802,4.6559], opdracht:'ğŸ­ Doe 10 fietsbellen tegelijk.' },
  { naam:'Terug naar Bergen', coords:[52.6696,4.7053], opdracht:'ğŸ‰ Marion is met pensioen! Applaus!' }
];

let huidigeIndex = 0;
let score = { A:0, B:0 };
let huidigeLocatie = null;

// =========================
// MAP
// =========================

const map = L.map('map').setView([52.6696,4.7053],13);

L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', { attribution:'Â© OpenStreetMap' }).addTo(map);

locaties.forEach(l => L.marker(l.coords).addTo(map).bindPopup(`<b>${l.naam}</b><br>${l.opdracht}`));

L.Routing.control({
  waypoints: locaties.map(l => L.latLng(l.coords[0],l.coords[1])),
  router: L.Routing.osrmv1({ serviceUrl:'https://router.project-osrm.org/route/v1', profile:'bike' }),
  lineOptions:{ styles:[{color:'#2563eb',weight:4}] },
  addWaypoints:false, draggableWaypoints:false, show:false, fitSelectedRoutes:true
}).addTo(map);

// =========================
// GAME LOGIC
// =========================

function volgendeLocatie() {
  if (huidigeIndex >= locaties.length) {
    document.getElementById('info').innerHTML = 'ğŸ‰ Einde spel! Marion geniet van je pensioen!';
    return;
  }

  huidigeLocatie = locaties[huidigeIndex];
  document.getElementById('info').innerHTML = `ğŸ“ <b>${huidigeLocatie.naam}</b><br>${huidigeLocatie.opdracht}<br><i>Loop/fiets hierheen om te starten</i>`;
  huidigeIndex++;
}

function shuffleTeams() {
  const mix = [...spelers].sort(() => Math.random()-0.5);
  const half = Math.ceil(mix.length/2);
  const teamA = mix.slice(0,half);
  const teamB = mix.slice(half);

  score.A += 1; score.B += 1; // bonus voor nieuwe teams

  document.getElementById('info').innerHTML = `ğŸ‘¥ <b>Nieuwe teams</b><br>Team A: ${teamA.join(', ')}<br>Team B: ${teamB.join(', ')}`;
  updateScore();
}

function puntenTeam(team) {
  score[team] += 1;
  updateScore();
}

function updateScore() {
  document.getElementById('score').innerHTML = `ğŸ† Score<br>Team A: ${score.A}<br>Team B: ${score.B}`;
}

// =========================
// GPS CHECK (optioneel, simpel)
// =========================

if (navigator.geolocation) {
  navigator.geolocation.watchPosition(pos => {
    if (!huidigeLocatie) return;
    const d = afstand(pos.coords.latitude, pos.coords.longitude, huidigeLocatie.coords[0], huidigeLocatie.coords[1]);
    if (d < 50) {
      document.getElementById('info').innerHTML += '<br>âœ… Aangekomen! Doe de opdracht.';
    }
  });
}

function afstand(lat1, lon1, lat2, lon2) {
  const R = 6371e3;
  const toRad = x => x*Math.PI/180;
  const dLat = toRad(lat2-lat1);
  const dLon = toRad(lon2-lon1);
  const a = Math.sin(dLat/2)**2 + Math.cos(toRad(lat1))*Math.cos(toRad(lat2))*Math.sin(dLon/2)**2;
  return R * 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
}
</script></body>
</html>
